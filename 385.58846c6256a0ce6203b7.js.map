{"version":3,"file":"385.58846c6256a0ce6203b7.js","mappings":"uGAMAA,EAAEC,UAAYD,EAAEE,QAAQC,OAAO,CAC7BC,WAAY,SAAUC,EAAMC,EAAQC,GAClCC,KAAKC,KAAM,IAAIC,MAAOC,UACtBH,KAAKH,KAAOA,EACZG,KAAKF,OAASA,EACVC,IACFC,KAAKD,QAAUA,GACjBK,GAAGC,OAAO,QACPC,OAAO,SAASC,KAAK,OAAQ,WAElC,EAMAC,YAAa,WACNR,KAAKF,OAGRE,KAAKF,OAAOE,KAAKS,UAAWT,KAAKU,WAFjCV,KAAKH,KAAKG,KAAKS,UAAWT,KAAKU,UAGnC,EAEAC,MAAO,SAAUC,GACfZ,KAAKY,IAAMA,EACX,IAAIC,EAAOb,KAEXA,KAAKc,KAAO,IAAItB,EAAEuB,IAClBH,EAAII,SAAShB,KAAKc,MAElBd,KAAKiB,WAAab,GAAGC,OAAOL,KAAKc,KAAKG,YAAYC,QAAQ,cAAc,GACxElB,KAAKS,UAAYT,KAAKiB,WAEtBjB,KAAKU,UAAY,CAEfS,gBAAiB,SAAUC,EAAGC,GAC5B,IAAIC,EAAUF,aAAa5B,EAAE+B,OAASH,EAAI,IAAI5B,EAAE+B,OAAOH,EAAGC,GACtDG,EAAQX,EAAKD,IAAIa,mBAAmBH,GACxCtB,KAAK0B,OAAOF,MAAMA,EAAMG,EAAGH,EAAMI,EACnC,EAEAC,cAAe,WACb,OAAO,IAAMC,KAAKC,IAAI,EAAGnB,EAAIoB,WAAa,QAC5C,EACApB,IAAKC,EAAKD,IACVqB,MAAOpB,GAGTb,KAAKU,UAAUwB,gBACb9B,GAAG+B,IAAIC,OAAOC,WAAWjC,GAAG+B,IAAIzB,UAAU,CACxCc,MAAOxB,KAAKU,UAAUS,mBAG1BnB,KAAKH,KAAKG,KAAKS,UAAWT,KAAKU,WAE3BV,KAAKF,QACPE,KAAKF,OAAOE,KAAKS,UAAWT,KAAKU,WAEnCE,EAAI0B,iBAAiB,UAAWtC,KAAKQ,YAAaR,KAGpD,EAGAuC,SAAU,SAAU3B,GAClBA,EAAI4B,oBAAoB,UAAWxC,KAAKQ,YAAaR,MACrDA,KAAKiB,WAAWwB,SAChB7B,EAAI8B,cAAc1C,KAAKc,KACzB,EAMA6B,aAAc,WACZ,GAAI3C,KAAKc,MAAQd,KAAKc,KAAKG,WAAY,CACrC,IAAI2B,EAAK5C,KAAKc,KAAKG,WAAW4B,WAC9BD,EAAGC,WAAWC,YAAYF,EAE5B,CACA,OAAO5C,IACT,EAOA+C,YAAa,WACX,GAAI/C,KAAKc,MAAQd,KAAKc,KAAKG,WAAY,CACrC,IAAI2B,EAAK5C,KAAKc,KAAKG,WAAW4B,WAC1BG,EAASJ,EAAGC,WAChBG,EAAOC,aAAaL,EAAII,EAAOE,WAEjC,CACA,OAAOlD,IACT,G","sources":["webpack://micro-app-tianditu-/./src/assets/lib/D3SvgOverlay.js"],"sourcesContent":["/* eslint-disable */\n/**\n * T.D3Overlay借助D3.js强大的可视化功能，扩展天地图已有的覆盖物类 T.Overlay，\n * 使天地图表达的可视化信息，不仅仅只有地理数据展示，也可以结合更丰富的图形(柱图，饼图)来描述、展现数据。\n * 注：chrome、safari、IE9及以上浏览器。\n */\nT.D3Overlay = T.Overlay.extend({\n  initialize: function (init, redraw, options) {\n    this.uid = new Date().getTime();\n    this.init = init;\n    this.redraw = redraw;\n    if (options)\n      this.options = options;\n    d3.select(\"head\")\n      .append(\"style\").attr(\"type\", \"text/css\")\n\n  },\n\n  /**\n   * 地图缩放触发的函数\n   * @private\n   */\n  _zoomChange: function () {\n    if (!this.redraw)\n      this.init(this.selection, this.transform);\n    else\n      this.redraw(this.selection, this.transform);\n  },\n\n  onAdd: function (map) {\n    this.map = map;\n    var self = this;\n    //增加svg容器\n    this._svg = new T.SVG();\n    map.addLayer(this._svg);\n    //根节点\n    this._rootGroup = d3.select(this._svg._rootGroup).classed(\"d3-overlay\", true);\n    this.selection = this._rootGroup;\n    //一些转换参数\n    this.transform = {\n      //坐标转容器像素坐标。\n      LngLatToD3Point: function (a, b) {\n        var _lnglat = a instanceof T.LngLat ? a : new T.LngLat(a, b);\n        var point = self.map.lngLatToLayerPoint(_lnglat);\n        this.stream.point(point.x, point.y);\n      },\n      //换算一米转多少像素\n      unitsPerMeter: function () {\n        return 256 * Math.pow(2, map.getZoom()) / 40075017\n      },\n      map: self.map,\n      layer: self\n\n    };\n    this.transform.pathFromGeojson =\n      d3.geo.path().projection(d3.geo.transform({\n        point: this.transform.LngLatToD3Point\n      }));\n    //D3绘制\n    this.init(this.selection, this.transform);\n    //用于确定坐标的\n    if (this.redraw)\n      this.redraw(this.selection, this.transform);\n\n    map.addEventListener(\"zoomend\", this._zoomChange, this);\n\n\n  },\n\n\n  onRemove: function (map) {\n    map.removeEventListener(\"zoomend\", this._zoomChange, this);\n    this._rootGroup.remove();\n    map.removeOverLay(this._svg)\n  },\n\n  /**\n   * 图层移动到最上层\n   * @returns {T.D3Overlay}\n   */\n  bringToFront: function () {\n    if (this._svg && this._svg._rootGroup) {\n      var el = this._svg._rootGroup.parentNode;\n      el.parentNode.appendChild(el);\n\n    }\n    return this;\n  },\n\n\n  /**\n   * 图层移动到最底层。\n   * @returns {T.D3Overlay}\n   */\n  bringToBack: function () {\n    if (this._svg && this._svg._rootGroup) {\n      var el = this._svg._rootGroup.parentNode;\n      var parent = el.parentNode;\n      parent.insertBefore(el, parent.firstChild);\n\n    }\n    return this;\n  },\n});\n"],"names":["T","D3Overlay","Overlay","extend","initialize","init","redraw","options","this","uid","Date","getTime","d3","select","append","attr","_zoomChange","selection","transform","onAdd","map","self","_svg","SVG","addLayer","_rootGroup","classed","LngLatToD3Point","a","b","_lnglat","LngLat","point","lngLatToLayerPoint","stream","x","y","unitsPerMeter","Math","pow","getZoom","layer","pathFromGeojson","geo","path","projection","addEventListener","onRemove","removeEventListener","remove","removeOverLay","bringToFront","el","parentNode","appendChild","bringToBack","parent","insertBefore","firstChild"],"sourceRoot":""}