(self.webpackChunkmicro_app_tianditu_=self.webpackChunkmicro_app_tianditu_||[]).push([[385],{2385:()=>{T.D3Overlay=T.Overlay.extend({initialize:function(t,i,o){this.uid=(new Date).getTime(),this.init=t,this.redraw=i,o&&(this.options=o),d3.select("head").append("style").attr("type","text/css")},_zoomChange:function(){this.redraw?this.redraw(this.selection,this.transform):this.init(this.selection,this.transform)},onAdd:function(t){this.map=t;var i=this;this._svg=new T.SVG,t.addLayer(this._svg),this._rootGroup=d3.select(this._svg._rootGroup).classed("d3-overlay",!0),this.selection=this._rootGroup,this.transform={LngLatToD3Point:function(t,o){var e=t instanceof T.LngLat?t:new T.LngLat(t,o),s=i.map.lngLatToLayerPoint(e);this.stream.point(s.x,s.y)},unitsPerMeter:function(){return 256*Math.pow(2,t.getZoom())/40075017},map:i.map,layer:i},this.transform.pathFromGeojson=d3.geo.path().projection(d3.geo.transform({point:this.transform.LngLatToD3Point})),this.init(this.selection,this.transform),this.redraw&&this.redraw(this.selection,this.transform),t.addEventListener("zoomend",this._zoomChange,this)},onRemove:function(t){t.removeEventListener("zoomend",this._zoomChange,this),this._rootGroup.remove(),t.removeOverLay(this._svg)},bringToFront:function(){if(this._svg&&this._svg._rootGroup){var t=this._svg._rootGroup.parentNode;t.parentNode.appendChild(t)}return this},bringToBack:function(){if(this._svg&&this._svg._rootGroup){var t=this._svg._rootGroup.parentNode,i=t.parentNode;i.insertBefore(t,i.firstChild)}return this}})}}]);